<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>FOV MATCH APP</title>

<style>
  :root{
    --bg:#0b0b0b;
    --card:#141414;
    --border:#262626;
    --text:#ffffff;
    --muted:#9a9a9a;
    --button:#ffffff;
    --buttonText:#000000;
  }
  *{box-sizing:border-box}
  body{
    margin:0; padding:16px;
    font-family:system-ui,-apple-system,BlinkMacSystemFont,"Helvetica Neue",Arial;
    background:var(--bg); color:var(--text);
    max-width:820px; margin-inline:auto;
  }
  h1{font-size:28px; letter-spacing:.5px; margin:0 0 14px;}
  .card{
    background:var(--card);
    border:1px solid var(--border);
    border-radius:16px;
    padding:16px;
    margin-bottom:16px;
  }
  .grid{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:14px;
  }
  label{
    display:block;
    font-size:12px;
    letter-spacing:.8px;
    color:var(--muted);
    margin-bottom:6px;
  }
  input{
    width:100%;
    padding:14px 12px;
    font-size:17px;
    color:var(--text);
    background:#0f0f0f;
    border:1px solid var(--border);
    border-radius:12px;
    outline:none;
  }
  input::placeholder{color:#666;}
  input:focus{border-color:#fff;}
  input.solvedTarget{border:2px solid #fff; font-weight:700;}
  button{
    width:100%;
    margin-top:16px;
    padding:16px;
    font-size:17px;
    font-weight:800;
    letter-spacing:1px;
    border-radius:14px;
    border:none;
    background:var(--button);
    color:var(--buttonText);
    cursor:pointer;
  }
  button:active{transform:scale(.99);}
  .out{font-size:18px; font-weight:700;}
  .muted{margin-top:6px; font-size:13px; color:var(--muted);}
  .bold{font-weight:900;}
</style>
</head>

<body>
<h1>FOV MATCH APP</h1>

<div class="card">
  <div class="grid">
    <div>
      <label>A LENS (mm)</label>
      <input id="aLens" type="number" step="0.1" min="0.1" placeholder="e.g. 36">
    </div>
    <div>
      <label>B LENS (mm)</label>
      <input id="bLens" type="number" step="0.1" min="0.1" placeholder="e.g. 29">
    </div>

    <div>
      <label>A DISTANCE</label>
      <input id="aDist" placeholder="6’7”  |  6’ 7”  |  6 feet 7  |  79in">
    </div>
    <div>
      <label>B DISTANCE</label>
      <input id="bDist" placeholder="leave blank to solve">
    </div>
  </div>

  <button id="calcBtn">CALCULATE</button>
</div>

<div class="card">
  <div class="out" id="result">—</div>
  <div class="muted" id="detail">Enter any 3 fields, leave 1 blank, press CALCULATE.</div>
</div>

<script>
  const el = id => document.getElementById(id);
  const isBlank = s => s === null || s === undefined || String(s).trim() === "";

  function normalizeQuotes(s){
    return String(s)
      .replace(/[’′]/g,"'")      // feet marks
      .replace(/[“”″]/g,'"')     // inch marks
      .replace(/feet/g,"ft")
      .replace(/foot/g,"ft")
      .replace(/\bft\.\b/g,"ft")
      .replace(/inches/g,"in")
      .replace(/inch/g,"in")
      .replace(/\bin\.\b/g,"in")
      .trim()
      .toLowerCase();
  }

  // Accepts: 6’7” | 6’ 7” | 6'7" | 6 ft 7 in | 6 feet 7 | 6ft7in | 6 7 | 79in | 79"
  function parseDistanceToInches(raw){
    if (isBlank(raw)) return NaN;
    let s = normalizeQuotes(raw);

    // remove extra spaces around symbols/words for easier matching
    s = s.replace(/\s+/g,' ');

    // 79in / 79"
    let m = s.match(/^(\d+(?:\.\d+)?)\s*(in|")$/);
    if (m) return Number(m[1]);

    // 6ft 7in (in optional)
    m = s.match(/^(\d+(?:\.\d+)?)\s*(ft|')\s*(\d+(?:\.\d+)?)?\s*(in|")?$/);
    if (m){
      const ft = Number(m[1]);
      const inch = m[3] ? Number(m[3]) : 0;
      return ft*12 + inch;
    }

    // 6 ft 7 in (with spaces)
    m = s.match(/^(\d+(?:\.\d+)?)\s*ft\s*(\d+(?:\.\d+)?)?\s*(in)?$/);
    if (m){
      const ft = Number(m[1]);
      const inch = m[2] ? Number(m[2]) : 0;
      return ft*12 + inch;
    }

    // "6 7" => 6ft 7in
    m = s.match(/^(\d+(?:\.\d+)?)\s+(\d+(?:\.\d+)?)$/);
    if (m) return Number(m[1])*12 + Number(m[2]);

    // pure number => inches
    m = s.match(/^(\d+(?:\.\d+)?)$/);
    if (m) return Number(m[1]);

    return NaN;
  }

  function inchesToFeetInString(totalInches){
    if (!(totalInches >= 0)) return "";
    const ft = Math.floor(totalInches / 12);
    let inch = totalInches - ft*12;

    // nearest 1/8"
    inch = Math.round(inch * 8) / 8;

    // carry
    if (inch >= 12) return `${ft+1}’0”`;

    // clean decimals (already 1/8)
    const inchStr = inch.toFixed(3).replace(/\.?0+$/,'');
    return `${ft}’${inchStr}”`;
  }

  function clearSolved(){
    ['aDist','bDist','aLens','bLens'].forEach(id => el(id).classList.remove('solvedTarget'));
  }

  function normalizeDistanceField(id){
    const v = el(id).value;
    if (isBlank(v)) return;
    const inches = parseDistanceToInches(v);
    if (!(inches > 0)) return;
    el(id).value = inchesToFeetInString(inches);
  }

  function solveOnButton(){
    clearSolved();

    // Always show distances in feet+inches for any filled distance fields
    normalizeDistanceField('aDist');
    normalizeDistanceField('bDist');

    const aD = el('aDist').value;
    const bD = el('bDist').value;
    const aL = el('aLens').value;
    const bL = el('bLens').value;

    const blanks = [
      isBlank(aL) ? 'aLens' : null,
      isBlank(bL) ? 'bLens' : null,
      isBlank(aD) ? 'aDist' : null,
      isBlank(bD) ? 'bDist' : null
    ].filter(Boolean);

    if (blanks.length !== 1){
      el('result').textContent = "—";
      el('detail').textContent = "Enter any 3 fields, leave 1 blank, press CALCULATE.";
      return;
    }

    const target = blanks[0];

    const A = parseFloat(aL);
    const B = parseFloat(bL);
    const aIn = parseDistanceToInches(aD);
    const bIn = parseDistanceToInches(bD);

    // bDist = aDist * (B/A)
    if (target === 'bDist'){
      if (!(aIn > 0) || !(A > 0) || !(B > 0)) return;
      const solved = aIn * (B / A);
      const pretty = inchesToFeetInString(solved);
      el('bDist').value = pretty;
      el('bDist').classList.add('solvedTarget');
      el('result').innerHTML = `B DISTANCE = <span class="bold">${pretty}</span>`;
      el('detail').textContent = "B DISTANCE = A DISTANCE × (B LENS ÷ A LENS)";
      return;
    }

    // aDist = bDist * (A/B)
    if (target === 'aDist'){
      if (!(bIn > 0) || !(A > 0) || !(B > 0)) return;
      const solved = bIn * (A / B);
      const pretty = inchesToFeetInString(solved);
      el('aDist').value = pretty;
      el('aDist').classList.add('solvedTarget');
      el('result').innerHTML = `A DISTANCE = <span class="bold">${pretty}</span>`;
      el('detail').textContent = "A DISTANCE = B DISTANCE × (A LENS ÷ B LENS)";
      return;
    }

    // bLens = aLens * (bDist/aDist)
    if (target === 'bLens'){
      if (!(aIn > 0) || !(bIn > 0) || !(A > 0)) return;
      const solved = A * (bIn / aIn);
      const pretty = solved.toFixed(2);
      el('bLens').value = pretty;
      el('bLens').classList.add('solvedTarget');
      el('result').innerHTML = `B LENS = <span class="bold">${pretty} mm</span>`;
      el('detail').textContent = "B LENS = A LENS × (B DISTANCE ÷ A DISTANCE)";
      return;
    }

    // aLens = bLens * (aDist/bDist)
    if (target === 'aLens'){
      if (!(aIn > 0) || !(bIn > 0) || !(B > 0)) return;
      const solved = B * (aIn / bIn);
      const pretty = solved.toFixed(2);
      el('aLens').value = pretty;
      el('aLens').classList.add('solvedTarget');
      el('result').innerHTML = `A LENS = <span class="bold">${pretty} mm</span>`;
      el('detail').textContent = "A LENS = B LENS × (A DISTANCE ÷ B DISTANCE)";
      return;
    }
  }

  el('calcBtn').addEventListener('click', solveOnButton);
</script>

</body>
</html>
